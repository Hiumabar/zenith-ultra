<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Zenith Ultra - Arsitektur Finansial Masa Depan</title>
    <meta name="description" content="Zenith Ultra: Aplikasi manajemen keuangan cerdas dengan sistem tracking streak, heatmap aktivitas, dan analisis portofolio premium.">
    
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://zenith-ultra-save.netlify.app/"> 
    <meta property="og:title" content="Zenith Ultra - Arsitektur Finansial Masa Depan">
    <meta property="og:description" content="Pantau progres menabung, streak harian, dan analisis portofolio premium dalam satu aplikasi cerdas.">
    <meta property="og:image" content="https://i.ibb.co.com/PLCqHHz/app-icon.png">

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:title" content="Zenith Ultra - Arsitektur Finansial Masa Depan">
    <meta property="twitter:description" content="Kelola keuanganmu dengan arsitektur masa depan di Zenith Ultra!">
    <meta property="twitter:image" content="https://i.ibb.co.com/PLCqHHz/app-icon.png">

    <meta name="google-site-verification" content="HuH731if_mx1v-_UBpD2SQ61c2JBhEEctxXELLG40sc" />
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#10b981">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="icon" type="image/png" href="https://i.ibb.co.com/PLCqHHz/app-icon.png">
    <link rel="apple-touch-icon" href="https://i.ibb.co.com/PLCqHHz/app-icon.png">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        :root { --bg: #030712; --card: #111827; --text: #f9fafb; --prim: #10b981; --border: #1f2937; --sec: #374151; --accent: #f59e0b; --danger: #ef4444; --shadow: rgba(0,0,0,0.4); }
        .light-mode { --bg: #f3f4f6; --card: #ffffff; --text: #111827; --border: #e5e7eb; --prim: #059669; --sec: #d1d5db; --accent: #d97706; --shadow: rgba(0,0,0,0.1); }
        
        * { box-sizing: border-box; font-family: 'Inter', -apple-system, sans-serif; transition: 0.25s cubic-bezier(0.4, 0, 0.2, 1); -webkit-user-select: none; user-select: none; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: var(--text); margin: 0; padding: 16px; padding-bottom: 200px; overflow-x: hidden; scroll-behavior: smooth; }
        .reveal { opacity: 0; transform: translateY(30px); transition: all 0.6s ease-out; }
        .reveal.active { opacity: 1; transform: translateY(0); }
        .card { background: var(--card); border-radius: 24px; padding: 24px; margin-bottom: 16px; border: 1px solid var(--border); box-shadow: 0 10px 15px -3px var(--shadow); position: relative; }
        .flex { display: flex; justify-content: space-between; align-items: center; }
        .badge { font-size: 10px; padding: 4px 10px; border-radius: 50px; font-weight: bold; background: var(--prim); color: #000; }
        .streak-badge { background: rgba(245, 158, 11, 0.1); color: var(--accent); border: 1px solid var(--accent); }
        .heat-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; margin-top: 10px; }
        .cell { aspect-ratio: 1; background: var(--sec); border-radius: 5px; }
        .cell.active { background: var(--prim); box-shadow: 0 0 12px var(--prim); }
        .p-bg { background: var(--sec); height: 10px; border-radius: 10px; margin: 12px 0; overflow: hidden; }
        .p-fill { background: linear-gradient(90deg, var(--prim), #34d399); height: 100%; transition: 1.5s cubic-bezier(0.17, 0.67, 0.83, 0.67); }
        .btn { border: none; padding: 14px; border-radius: 18px; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 14px; position: relative; }
        .btn:active { transform: scale(0.92); }
        .btn-prim { background: var(--prim); color: #000; box-shadow: 0 8px 20px -6px var(--prim); }
        .btn-sec { background: var(--card); color: var(--text); border: 1px solid var(--border); }
        .btn-del { background: transparent; color: var(--danger); border: none; padding: 5px; cursor: pointer; font-size: 18px; }
        .fab-container { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); width: 92%; max-width: 420px; background: rgba(17, 24, 39, 0.7); backdrop-filter: blur(25px); padding: 10px; border-radius: 100px; display: flex; gap: 10px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); border: 1px solid rgba(255,255,255,0.08); z-index: 1000; }
        .fab-btn { border-radius: 100px !important; flex: 1; height: 54px; }
        .fab-main { flex: 2.2; background: var(--prim); color: #000; }
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); backdrop-filter: blur(15px); display: none; align-items: center; justify-content: center; z-index: 2000; padding: 20px; opacity: 0; }
        .modal.active { display: flex; opacity: 1; }
        .modal-content { background: var(--card); width: 100%; max-width: 500px; border-radius: 32px; padding: 28px; max-height: 90vh; overflow-y: auto; border: 1px solid var(--border); }
        input, select, textarea { width: 100%; padding: 16px; border-radius: 16px; background: var(--bg); color: var(--text); border: 1px solid var(--border); margin-bottom: 16px; outline: none; font-size: 16px; }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin: 20px 0; }
        .stat-item { background: var(--bg); padding: 16px; border-radius: 20px; border: 1px solid var(--border); }
        .stat-label { font-size: 10px; opacity: 0.5; text-transform: uppercase; letter-spacing: 1px; }
        .stat-val { font-size: 16px; font-weight: 800; color: var(--prim); margin-top: 4px; }
        .history-table { width: 100%; border-collapse: separate; border-spacing: 0 8px; font-size: 12px; }
        .history-table tr { background: var(--bg); }
        .history-table td { padding: 12px; border-top: 1px solid var(--border); border-bottom: 1px solid var(--border); }
        .history-table td:first-child { border-left: 1px solid var(--border); border-radius: 12px 0 0 12px; }
        .history-table td:last-child { border-right: 1px solid var(--border); border-radius: 0 12px 12px 0; }
        
        /* New Styles for Added Pages */
        .page-content { display: none; animation: fadeIn 0.5s ease; padding-bottom: 60px; }
        .page-content.active { display: block; }
        .nav-footer { text-align: center; margin-top: 40px; padding: 20px; border-top: 1px solid var(--border); opacity: 0.8; }
        .nav-links { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-bottom: 15px; }
        .nav-item { font-size: 12px; color: var(--prim); text-decoration: none; cursor: pointer; font-weight: 600; }
        .copyright { font-size: 11px; opacity: 0.5; margin-top: 10px; }
        .social-box { display: flex; justify-content: center; gap: 20px; margin: 15px 0; font-size: 20px; }
        .social-box a { text-decoration: none; color: var(--text); opacity: 0.7; }
        .social-box a:hover { opacity: 1; color: var(--prim); }

        /* Share Styles */
        .share-card { background: linear-gradient(135deg, #064e3b 0%, #030712 100%); padding: 30px; border-radius: 30px; border: 2px solid var(--prim); color: white; text-align: left; position: relative; overflow: hidden; }
        .share-card::after { content: 'ZENITH'; position: absolute; right: -20px; bottom: -10px; font-size: 80px; font-weight: 900; opacity: 0.05; font-style: italic; }
        .share-preview-container { margin: 20px 0; perspective: 1000px; }
        .preview-box { transform: rotateX(5deg); box-shadow: 0 20px 40px rgba(0,0,0,0.5); }
        
        #wizard { position: fixed; inset: 0; background: var(--bg); z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 30px; text-align: center; }
        .wiz-step { width: 100%; max-width: 400px; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
        
        .day-selector { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin: 20px 0; }
        .day-opt { padding: 10px 5px; border-radius: 12px; background: var(--sec); font-size: 11px; font-weight: bold; cursor: pointer; border: 2px solid transparent; }
        .day-opt.active { background: rgba(16, 185, 129, 0.2); border-color: var(--prim); color: var(--prim); }

        .modal-section-title { font-size: 11px; opacity: 0.5; letter-spacing: 1.5px; margin: 20px 0 10px 0; text-transform: uppercase; font-weight: 800; border-bottom: 1px solid var(--border); padding-bottom: 5px; }

.social-box { display: flex; justify-content: center; gap: 25px; margin: 20px 0; font-size: 24px; }
.social-box a { color: var(--text); opacity: 0.6; transition: 0.3s; }

/* Warna khusus saat di-hover */
.social-box a:hover { opacity: 1; transform: translateY(-3px); }
.social-box a:hover .fa-instagram { color: #e4405f; }
.social-box a:hover .fa-x-twitter { color: #1da1f2; }
.social-box a:hover .fa-github { color: #6e5494; }
.social-box a:hover .fa-envelope { color: var(--prim); }
        
    </style>
</head>
<body oncontextmenu="return false">

    <div id="wizard">
        <div class="wiz-step" id="step1">
            <h1 style="color:var(--prim); font-size: 48px; margin-bottom:10px; letter-spacing: -2px;">Zenith.</h1>
            <p style="opacity:0.7; font-size: 18px;">Arsitektur finansial masa depan Anda.</p>
            <button class="btn btn-prim" onclick="nextStep(2)" style="margin: 30px auto; width: 220px; border-radius: 100px;">Mulai Eksplorasi</button>
        </div>
        <div class="wiz-step" id="step2" style="display:none">
            <span style="font-size: 40px;">üéØ</span>
            <h2>Target Utama</h2>
            <p style="font-size:14px; opacity:0.6;">Apa impian besar pertama yang ingin dicapai?</p>
            <input type="text" id="oName" placeholder="Contoh: Dana Darurat">
            <input type="number" id="input_oGoal" placeholder="Target Nominal (Rp)">
            <button class="btn btn-prim" onclick="nextStep(3)" style="margin: 10px auto; width: 100%; border-radius: 100px;">Lanjut</button>
        </div>
        <div class="wiz-step" id="step3" style="display:none">
            <span style="font-size: 40px;">üìÖ</span>
            <h2>Jadwal Menabung</h2>
            <p style="font-size: 14px; opacity: 0.6;">Pilih hari spesifik untuk target ini.</p>
            <div class="day-selector" id="wizDayPicker">
                <div class="day-opt active" onclick="this.classList.toggle('active')" data-day="1">Senin</div>
                <div class="day-opt active" onclick="this.classList.toggle('active')" data-day="2">Selasa</div>
                <div class="day-opt active" onclick="this.classList.toggle('active')" data-day="3">Rabu</div>
                <div class="day-opt active" onclick="this.classList.toggle('active')" data-day="4">Kamis</div>
                <div class="day-opt active" onclick="this.classList.toggle('active')" data-day="5">Jumat</div>
                <div class="day-opt" onclick="this.classList.toggle('active')" data-day="6">Sabtu</div>
                <div class="day-opt" onclick="this.classList.toggle('active')" data-day="0">Minggu</div>
            </div>
            <button class="btn btn-prim" onclick="nextStep(4)" style="margin: 10px auto; width: 100%; border-radius: 100px;">Tinjau Sistem</button>
        </div>
        <div class="wiz-step" id="step4" style="display:none">
            <div style="font-size: 60px; margin-bottom: 10px;">‚ú®</div>
            <h2>Sistem Siap</h2>
            <p style="font-size: 14px; opacity: 0.6; margin-bottom: 30px;">Zenith telah dikonfigurasi. Streak akan dihitung berdasarkan hari yang Anda pilih.</p>
            <button class="btn btn-prim" onclick="initApp()" style="margin: 0 auto; width: 100%; border-radius: 100px;">Aktifkan Zenith</button>
        </div>
    </div>

    <div id="main-app-ui">
        <div class="flex reveal" style="margin-bottom:20px; padding-top: 10px;">
            <h2 onclick="showPage('home')" style="margin:0; letter-spacing:-1.5px; font-weight: 900; font-size: 24px; cursor:pointer;">ZENITH ULTRA<span style="color:var(--prim)">.</span></h2>
            <div class="flex" style="gap:10px;">
                <div class="badge streak-badge">üî• <span id="stkVal">0</span> DAYS</div>
                <button onclick="toggleTheme()" class="btn btn-sec" style="padding:0; border-radius:50%; width:44px; height:44px; border: none; background: var(--card);">üåì</button>
            </div>
        </div>

        <div id="page-home" class="page-container">
            <div class="card reveal" onclick="openStats()" style="cursor: pointer;">
                <div class="flex">
                    <span style="font-size:10px; font-weight:800; opacity:0.6; letter-spacing: 1.5px;">MARKET ANALYTICS</span>
                    <span id="levelBadge" class="badge">Bronze Tier</span>
                </div>
                <div class="heat-grid" id="heatGrid"></div>
                <canvas id="mainChart" height="140" style="margin-top:20px;"></canvas>
            </div>
            <div id="targetList"></div>
        </div>

        <div id="page-about" class="page-content">
            <div class="card">
                <h3 style="color:var(--prim)">Tentang Zenith Ultra</h3>
                <p style="line-height:1.6; opacity:0.9;">Zenith Ultra adalah platform manajemen keuangan personal yang mengusung konsep <b>Arsitektur Finansial</b>. Website ini dirancang untuk mereka yang ingin disiplin dalam menabung melalui sistem gamifikasi.</p>
                <div class="modal-section-title">Fitur Unggulan</div>
                <ul style="padding-left: 20px; line-height: 1.8;">
                    <li><b>Daily Streak:</b> Menjaga momentum menabung Anda tetap membara.</li>
                    <li><b>Activity Heatmap:</b> Visualisasi kontribusi tabungan secara periodik.</li>
                    <li><b>Premium Export:</b> Simpan data Anda dalam format PDF atau Excel.</li>
                    <li><b>Smart Estimation:</b> Prediksi kapan target Anda akan tercapai berdasarkan tren.</li>
                </ul>
            </div>
        </div>

        <div id="page-contact" class="page-content">
            <div class="card">
                <h3 style="color:var(--prim)">Hubungi Kami</h3>
                <p style="font-size:13px; opacity:0.7; margin-bottom:20px;">Punya pertanyaan atau saran? Kirimkan pesan langsung kepada tim pengembang kami.</p>
                <form action="https://formspree.io/f/xgolneye" method="POST">
                    <input type="text" name="name" placeholder="Nama Lengkap" required>
                    <input type="email" name="email" placeholder="Email Anda" required>
                    <textarea name="message" rows="4" placeholder="Tulis pesan Anda di sini..." required style="resize: none;"></textarea>
                    <button type="submit" class="btn btn-prim" style="width:100%">Kirim Pesan Sekarang</button>
                </form>
                
             
                <div class="modal-section-title" style="text-align: center;">Social Media</div>
<div class="social-box">
    <a href="https://instagram.com/nextterrastudio" target="_blank" title="Instagram">
        <i class="fab fa-instagram"></i>
    </a>
    <a href="https://twitter.com/nextterrastudio" target="_blank" title="Twitter/X">
        <i class="fab fa-x"></i>
    </a>
    <a href="https://github.com/Hiumabar" target="_blank" title="GitHub">
        <i class="fab fa-github"></i>
    </a>
    <a href="mailto:nextterrastudio@gmail.com" title="Email Kami">
        <i class="fas fa-envelope"></i>
    </a>
</div>


            </div>
        </div>

        <div id="page-privacy" class="page-content">
            <div class="card">
                <h3>Kebijakan Privasi</h3>
                <p style="font-size:14px; line-height:1.6; opacity:0.8;">
                    Keamanan data Anda adalah prioritas kami. Zenith Ultra beroperasi dengan prinsip <b>Offline-First</b>. Semua data transaksi, target, dan histori Anda disimpan di penyimpanan lokal (LocalStorage) perangkat Anda sendiri. <br><br>
                    Kami tidak mengunggah data finansial Anda ke server manapun. Anda memiliki kendali penuh untuk mengekspor atau menghapus data Anda kapan saja.
                </p>
            </div>
        </div>

        <div id="page-tos" class="page-content">
            <div class="card">
                <h3>Syarat & Ketentuan</h3>
                <p style="font-size:14px; line-height:1.6; opacity:0.8;">
                    Dengan menggunakan Zenith Ultra, Anda memahami bahwa aplikasi ini adalah alat bantu pencatatan finansial pribadi. <br><br>
                    1. Pengguna bertanggung jawab penuh atas data yang dimasukkan.<br>
                    2. Kami tidak bertanggung jawab atas kehilangan data akibat penghapusan cache browser atau kerusakan perangkat.<br>
                    3. Zenith Ultra bukan lembaga keuangan dan tidak mengelola dana nyata Anda.
                </p>
            </div>
        </div>

        <footer class="nav-footer reveal">
            <div class="nav-links">
                <span class="nav-item" onclick="showPage('home')">Beranda</span>
                <span class="nav-item" onclick="showPage('about')">Tentang</span>
                <span class="nav-item" onclick="showPage('contact')">Kontak</span>
                <span class="nav-item" onclick="showPage('privacy')">Privasi</span>
                <span class="nav-item" onclick="showPage('tos')">Syarat & Ketentuan</span>
            </div>
            <div class="copyright">
                Next Terra Studio 2026 &copy; All Rights Reserved.
            </div>
        </footer>
    </div>

    <div class="fab-container">
        <button class="btn btn-sec fab-btn" onclick="openModal('exportModal')">üíæ</button>
        <button class="btn fab-btn fab-main" onclick="openModal('saveModal')">
            <b>üí∞ TRANSAKSI</b>
        </button>
        <button class="btn btn-sec fab-btn" onclick="openModal('targetModal')">üéØ</button>
    </div>

    <div id="exportModal" class="modal">
        <div class="modal-content">
            <h3 style="margin-top:0">Manajemen Data</h3>
            
            <div class="modal-section-title">Data Portofolio</div>
            <button class="btn btn-prim" onclick="handleExport('pdf')" style="margin-bottom:12px; background:#ef4444; color:white; width: 100%;">üìï Ekspor PDF Premium</button>
            <button class="btn btn-prim" onclick="handleExport('excel')" style="margin-bottom:12px; background:#10b981; color:black; width: 100%;">üìó Ekspor Excel</button>
            
            <div class="modal-section-title">Cloud Backup</div>
            <button class="btn btn-sec" onclick="backupData()" style="width:100%; margin-bottom:10px;">üì§ Salin Backup Kode</button>
            <button class="btn btn-sec" onclick="downloadJSON()" style="width:100%; margin-bottom:10px;">üìÑ Simpan File JSON</button>
            
            <input type="file" id="importFile" style="display:none" accept=".json" onchange="handleFileImport(event)">
            <button class="btn btn-sec" onclick="triggerRestore()" style="width:100%; border: 1px dashed var(--prim);">üì• Pulihkan Data (File/Kode)</button>

            <div class="modal-section-title">Share</div>
            <button class="btn btn-prim" onclick="openShare()" style="margin-bottom:12px; background:linear-gradient(45deg, #10b981, #3b82f6); color:white; width: 100%;">üîó Bagikan Pencapaian (Card)</button>
            <button class="btn btn-sec" onclick="shareWebsite()" style="margin-bottom:12px; border: 1px solid var(--prim); width: 100%;">üåê Bagikan Link Website</button>

            <button class="btn btn-sec" onclick="closeModal('exportModal')" style="width:100%; margin-top:20px; border-radius: 100px;">Tutup</button>
        </div>
    </div>

    <div id="shareModal" class="modal">
        <div class="modal-content" style="max-width: 450px;">
            <h3 style="margin-top:0">Zenith Share Card</h3>
            <div id="shareArea" class="share-preview-container">
                <div class="share-card preview-box" id="captureTarget">
                    <div style="font-size: 10px; letter-spacing: 2px; opacity: 0.8; margin-bottom: 5px;">ZENITH FINANCIAL ARCHITECT</div>
                    <h2 style="margin: 0; color: var(--prim); font-size: 28px;" id="sT_title">My Portfolio</h2>
                    <div style="margin: 25px 0;">
                        <div style="font-size: 12px; opacity: 0.7;">TOTAL ASSET VALUE</div>
                        <div style="font-size: 24px; font-weight: 900;" id="sT_assets">Rp 0</div>
                    </div>
                    <div class="flex">
                        <div>
                            <div style="font-size: 10px; opacity: 0.7;">STREAK</div>
                            <div style="font-size: 18px; font-weight: 700; color: #f59e0b;" id="sT_streak">0 Days</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 10px; opacity: 0.7;">STATUS</div>
                            <div id="sT_tier" style="font-weight: 700;">PRO MEMBER</div>
                        </div>
                    </div>
                    <div style="margin-top: 20px; font-size: 10px; opacity: 0.5; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 10px;">
                        Dibuat di Zenith Ultra - Digital Financial Tracker
                    </div>
                </div>
            </div>
            <button class="btn btn-prim" onclick="downloadShareCard()" style="width:100%;">üì∏ Simpan & Bagikan Gambar</button>
            <button class="btn btn-sec" onclick="closeModal('shareModal')" style="width:100%; margin-top:12px; border-radius: 100px;">Kembali</button>
        </div>
    </div>

    <div id="saveModal" class="modal">
        <div class="modal-content">
            <h3 style="margin-top:0">Input Transaksi</h3>
            <select id="saveType">
                <option value="in">üí∞ Masuk (Nabung)</option>
                <option value="out">üí∏ Keluar (Tarik)</option>
            </select>
            <select id="saveTo"></select>
            <input type="number" id="saveAmt" placeholder="Jumlah Rp" inputmode="numeric">
            <button class="btn btn-prim" onclick="handleSaveAction()" style="width: 100%;">Proses Transaksi</button>
            <button class="btn btn-sec" onclick="closeModal('saveModal')" style="width:100%; margin-top:12px; border-radius: 100px;">Batal</button>
        </div>
    </div>

    <div id="targetModal" class="modal">
        <div class="modal-content">
            <h3 style="margin-top:0">üéØ Target Baru</h3>
            <input type="text" id="ntName" placeholder="Nama Barang">
            <input type="number" id="ntGoal" placeholder="Target Dana">
            <p style="font-size: 12px; opacity: 0.6; margin-bottom: 8px;">Pilih Hari Menabung:</p>
            <div class="day-selector" id="targetDayPicker">
                <div class="day-opt active" onclick="this.classList.toggle('active')" data-day="1">Senin</div>
                <div class="day-opt active" onclick="this.classList.toggle('active')" data-day="2">Selasa</div>
                <div class="day-opt active" onclick="this.classList.toggle('active')" data-day="3">Rabu</div>
                <div class="day-opt active" onclick="this.classList.toggle('active')" data-day="4">Kamis</div>
                <div class="day-opt active" onclick="this.classList.toggle('active')" data-day="5">Jumat</div>
                <div class="day-opt" onclick="this.classList.toggle('active')" data-day="6">Sabtu</div>
                <div class="day-opt" onclick="this.classList.toggle('active')" data-day="0">Minggu</div>
            </div>
            <button class="btn btn-prim" onclick="doAddTarget()" style="width: 100%;">Simpan Target</button>
            <button class="btn btn-sec" onclick="closeModal('targetModal')" style="width:100%; margin-top:12px; border-radius: 100px;">Batal</button>
        </div>
    </div>

    <div id="statsModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="flex">
                <h3 style="color:var(--prim); margin:0">Zenith Insights</h3>
                <button class="btn-del" onclick="closeModal('statsModal')" style="font-size: 24px;">√ó</button>
            </div>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-label">Total Assets</div>
                    <div class="stat-val" id="statTotal">Rp 0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Saving Streak</div>
                    <div class="stat-val" id="statStreak">0 Days</div>
                </div>
            </div>
            <canvas id="barChart" height="200"></canvas>
            <h4 style="margin: 25px 0 15px 0; font-size: 14px; opacity: 0.7;">ACTIVITY LOG</h4>
            <div style="overflow-x: auto;">
                <table class="history-table">
                    <tbody id="historyBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let db = JSON.parse(localStorage.getItem('ss_ultra_db')) || { 
            targets: [], 
            logs: [], 
            streak: 0, 
            lastDate: null, 
            theme: 'dark'
        };

        function nextStep(s) { 
            const n = document.getElementById('oName').value;
            const g = document.getElementById('input_oGoal').value;
            if(s === 3 && (!n || !g)) return alert("Isi nama target dan nominal!");
            
            document.querySelectorAll('.wiz-step').forEach(el => el.style.display = 'none'); 
            document.getElementById('step'+s).style.display = 'block'; 
        }

        function initApp() { 
            const n = document.getElementById('oName').value;
            const g = document.getElementById('input_oGoal').value;
            const activeDays = Array.from(document.querySelectorAll('#wizDayPicker .day-opt.active')).map(el => parseInt(el.dataset.day));
            
            if(n && g && activeDays.length > 0) { 
                db.targets.push({name:n, goal:parseInt(g), saved:0, schedule: activeDays}); 
                save(); 
                document.getElementById('wizard').style.display = 'none';
            } else { alert("Pilih minimal 1 hari menabung!"); }
        }

        // NAVIGATION LOGIC
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page-content').forEach(p => p.classList.remove('active'));
            document.getElementById('page-home').style.display = 'none';
            
            if(pageId === 'home') {
                document.getElementById('page-home').style.display = 'block';
            } else {
                document.getElementById('page-' + pageId).classList.add('active');
            }
            window.scrollTo(0,0);
            reveal();
        }

        function shareWebsite() {
            if (navigator.share) {
                navigator.share({
                    title: 'Zenith Ultra',
                    text: 'Kelola keuanganmu dengan arsitektur masa depan di Zenith Ultra!',
                    url: window.location.href
                }).catch(console.error);
            } else {
                navigator.clipboard.writeText(window.location.href);
                alert("Link disalin ke clipboard!");
            }
        }

        function openShare() {
            closeModal('exportModal');
            const total = db.targets.reduce((a,b)=>a+b.saved, 0);
            const primaryTarget = db.targets[0] ? db.targets[0].name : "Zenith User";
            
            document.getElementById('sT_assets').innerText = `Rp ${total.toLocaleString()}`;
            document.getElementById('sT_streak').innerText = `${db.streak} DAYS`;
            document.getElementById('sT_title').innerText = primaryTarget.toUpperCase();
            document.getElementById('sT_tier').innerText = total > 1000000 ? "PLATINUM" : "GOLD MEMBER";
            
            openModal('shareModal');
        }

        async function downloadShareCard() {
            const area = document.getElementById('captureTarget');
            area.style.transform = "none";
            const canvas = await html2canvas(area, { backgroundColor: '#030712', borderRadius: 30 });
            const imgData = canvas.toDataURL('image/png');
            const link = document.createElement('a');
            link.download = 'Zenith-Portfolio.png';
            link.href = imgData;
            link.click();
            area.style.transform = "rotateX(5deg)";
        }

        function validateStreak() {
            if (!db.lastDate || db.streak === 0) return;
            const last = new Date(db.lastDate);
            const now = new Date();
            now.setHours(0,0,0,0); last.setHours(0,0,0,0);
            if(last.getTime() === now.getTime()) return;
            let allScheduledDays = new Set();
            db.targets.forEach(t => { if(t.schedule) t.schedule.forEach(d => allScheduledDays.add(d)); });
            let checkDate = new Date(last);
            checkDate.setDate(checkDate.getDate() + 1);
            while(checkDate < now) {
                if(allScheduledDays.has(checkDate.getDay())) { db.streak = 0; save(); return; }
                checkDate.setDate(checkDate.getDate() + 1);
            }
        }

        function handleSaveAction() {
            const idx = document.getElementById('saveTo').value;
            let amt = parseInt(document.getElementById('saveAmt').value);
            if(!amt || amt <= 0) return;
            const type = document.getElementById('saveType').value;
            if(type === 'out') {
                if(db.targets[idx].saved < amt) { alert("Saldo Tidak Cukup"); return; }
                amt = -amt;
            }
            db.targets[idx].saved += amt;
            const now = new Date();
            const todayStr = now.toDateString();
            if(amt > 0) {
                const targetSchedule = db.targets[idx].schedule || [1,2,3,4,5];
                if (db.lastDate !== todayStr && targetSchedule.includes(now.getDay())) {
                    db.streak++;
                    db.lastDate = todayStr;
                }
            }
            db.logs.push({ d: new Date().toISOString(), v: amt, t: db.targets[idx].name });
            closeModal('saveModal');
            document.getElementById('saveAmt').value = '';
            save();
        }

        function save() { localStorage.setItem('ss_ultra_db', JSON.stringify(db)); render(); }

        function render() {
            document.getElementById('wizard').style.display = db.targets.length === 0 ? 'flex' : 'none';
            document.getElementById('stkVal').innerText = db.streak;
            const list = document.getElementById('targetList');
            list.innerHTML = db.targets.map((t, i) => {
                const p = Math.min((t.saved/t.goal)*100, 100).toFixed(1);
                const dayLabels = ["Min","Sen","Sel","Rab","Kam","Jum","Sab"];
                const schedHint = t.schedule ? t.schedule.map(d => dayLabels[d]).join(", ") : "Hari Kerja";
                return `<div class="card reveal active"><div class="flex"><b style="font-size:18px">${t.name}</b><div class="flex" style="gap:12px;"><span class="badge">${p}%</span><button class="btn-del" onclick="deleteTarget(${i})">üóëÔ∏è</button></div></div><div class="p-bg"><div class="p-fill" style="width:${p}%"></div></div><div class="flex" style="font-size:12px; font-weight:700"><span>Rp ${t.saved.toLocaleString()}</span><span style="opacity:0.5">Target Rp ${t.goal.toLocaleString()}</span></div><div class="flex" style="font-size:10px; margin-top:12px; font-weight:800;"><span style="color:var(--accent)">‚ö° ${getEstimation(t)}</span><span style="opacity:0.4">üìÖ ${schedHint}</span></div></div>`;
            }).join('');
            renderHeatmap(); 
            renderLineChart();
            setTimeout(reveal, 100);
        }

        function getEstimation(target) {
            const remaining = target.goal - target.saved;
            if (remaining <= 0) return "Target Tercapai! üèÜ";
            const logs = db.logs.filter(l => l.t === target.name && l.v > 0);
            if (logs.length < 2) return "Menunggu data...";
            const start = new Date(logs[0].d);
            const end = new Date(logs[logs.length-1].d);
            const days = Math.max(1, Math.round((end - start) / 86400000));
            const total = logs.reduce((s, l) => s + l.v, 0);
            const avg = total / days;
            const daysLeft = Math.ceil(remaining / avg);
            return daysLeft > 30 ? `${(daysLeft/30).toFixed(1)} Bulan lagi` : `${daysLeft} Hari lagi`;
        }

        function renderHeatmap() {
            const h = document.getElementById('heatGrid'); h.innerHTML = '';
            const dates = db.logs.map(l => new Date(l.d).toDateString());
            for(let i=0; i<21; i++) {
                const d = new Date(); d.setDate(d.getDate() - (20-i));
                const c = document.createElement('div');
                c.className = 'cell' + (dates.includes(d.toDateString()) ? ' active' : '');
                h.appendChild(c);
            }
        }

        let lineChart, barChart;
        function renderLineChart() {
            const ctx = document.getElementById('mainChart').getContext('2d');
            const lastData = db.logs.slice(-10).map(l => l.v);
            if(lineChart) lineChart.destroy();
            lineChart = new Chart(ctx, { type: 'line', data: { labels: lastData.map(()=>""), datasets: [{ data: lastData, borderColor: '#10b981', tension: 0.4, fill: true, backgroundColor: 'rgba(16,185,129,0.1)', pointRadius: 0 }] }, options: { plugins: { legend: { display: false } }, scales: { y: { display: false }, x: { display: false } } } });
        }

        function openStats() {
            const total = db.targets.reduce((a,b)=>a+b.saved, 0);
            document.getElementById('statTotal').innerText = `Rp ${total.toLocaleString()}`;
            document.getElementById('statStreak').innerText = `${db.streak} Days`;
            const hBody = document.getElementById('historyBody');
            hBody.innerHTML = db.logs.slice().reverse().slice(0, 15).map(l => `<tr><td style="opacity:0.5">${new Date(l.d).toLocaleDateString('id-ID',{day:'2-digit', month:'short'})}</td><td><b>${l.t}</b></td><td style="text-align:right; color:${l.v > 0 ? 'var(--prim)' : 'var(--danger)'}">${l.v > 0 ? '+' : ''}${l.v.toLocaleString()}</td></tr>`).join('');
            openModal('statsModal');
            setTimeout(renderBarChart, 400);
        }

        function renderBarChart() {
            const ctx = document.getElementById('barChart').getContext('2d');
            const dataMap = {};
            db.logs.slice(-10).forEach(l => {
                const d = new Date(l.d).toLocaleDateString('id-ID', {day:'2-digit'});
                dataMap[d] = (dataMap[d] || 0) + Math.abs(l.v);
            });
            if(barChart) barChart.destroy();
            barChart = new Chart(ctx, { type: 'bar', data: { labels: Object.keys(dataMap), datasets: [{ data: Object.values(dataMap), backgroundColor: '#10b981', borderRadius: 8 }] }, options: { plugins: { legend: { display: false } }, scales: { y: { display: false }, x: { grid: { display: false } } } } });
        }

        function openModal(id) {
            const m = document.getElementById(id);
            if(id === 'saveModal' && db.targets.length === 0) return;
            m.style.display = 'flex';
            setTimeout(() => m.classList.add('active'), 10);
            if(id === 'saveModal') document.getElementById('saveTo').innerHTML = db.targets.map((t,i) => `<option value="${i}">${t.name}</option>`).join('');
        }

        function closeModal(id) {
            const m = document.getElementById(id);
            m.classList.remove('active');
            setTimeout(() => m.style.display = 'none', 300);
        }

        function doAddTarget() {
            const n = document.getElementById('ntName').value, g = document.getElementById('ntGoal').value;
            const activeDays = Array.from(document.querySelectorAll('#targetDayPicker .day-opt.active')).map(el => parseInt(el.dataset.day));
            if(n && g && activeDays.length > 0) {
                db.targets.push({name:n, goal:parseInt(g), saved:0, schedule: activeDays});
                save(); closeModal('targetModal');
                document.getElementById('ntName').value = ''; document.getElementById('ntGoal').value = '';
            } else { alert("Lengkapi data!"); }
        }

        function handleExport(type) {
            if(type === 'pdf') {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                doc.text("Laporan Zenith Ultra", 10, 10);
                const data = db.targets.map(t => [t.name, t.saved, t.goal]);
                doc.autoTable({ head: [['Target', 'Tersimpan', 'Goal']], body: data });
                doc.save('Zenith-Report.pdf');
            } else {
                let csv = "Nama,Tersimpan,Target\n";
                db.targets.forEach(t => { csv += `${t.name},${t.saved},${t.goal}\n` });
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url; a.download = 'Zenith-Data.csv'; a.click();
            }
        }

        function reveal() {
            document.querySelectorAll(".reveal").forEach(el => {
                if (el.getBoundingClientRect().top < window.innerHeight - 50) el.classList.add("active");
            });
        }

        function toggleTheme() { document.body.classList.toggle('light-mode'); }
        function deleteTarget(i) { if(confirm("Hapus target?")) { db.targets.splice(i,1); save(); } }
        
        function backupData() { 
            try {
                const base64Data = btoa(JSON.stringify(db));
                navigator.clipboard.writeText(base64Data).then(() => {
                    alert("‚úÖ Kode backup berhasil disalin ke clipboard!");
                });
            } catch (e) {
                alert("‚ùå Gagal membuat kode backup.");
            }
        }

        function downloadJSON() {
            const dataStr = JSON.stringify(db, null, 2);
            const blob = new Blob([dataStr], { type: "application/json" });
            const url = URL.createObjectURL(blob);
            const dlAnchor = document.createElement('a');
            dlAnchor.href = url;
            dlAnchor.download = `Zenith_Backup_${new Date().toISOString().slice(0,10)}.json`;
            document.body.appendChild(dlAnchor);
            dlAnchor.click();
            document.body.removeChild(dlAnchor);
            URL.revokeObjectURL(url);
        }

        function triggerRestore() {
            const choice = confirm("Klik 'OK' untuk masukkan KODE BACKUP, atau 'Cancel' untuk pilih FILE JSON.");
            if (choice) {
                const code = prompt("Tempel kode backup (Base64) di sini:");
                if (code) {
                    try {
                        processRestore(atob(code));
                    } catch(e) {
                        alert("‚ùå Kode tidak valid!");
                    }
                }
            } else {
                document.getElementById('importFile').click();
            }
        }

        function handleFileImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                processRestore(e.target.result);
            };
            reader.readAsText(file);
        }

        function processRestore(jsonString) {
            try {
                const importedData = JSON.parse(jsonString);
                if (importedData.targets && Array.isArray(importedData.targets)) {
                    if (confirm("‚ö†Ô∏è Semua data saat ini akan diganti. Lanjutkan?")) {
                        db = importedData;
                        localStorage.setItem('ss_ultra_db', JSON.stringify(db));
                        alert("‚úÖ Data berhasil dipulihkan!");
                        location.reload();
                    }
                } else {
                    throw new Error("Format data tidak sesuai.");
                }
            } catch (e) {
                alert("‚ùå Error: Format backup tidak valid!");
            }
            document.getElementById('importFile').value = '';
        }

        window.addEventListener("scroll", reveal);
        validateStreak();
        render();
    </script>
</body>
</html>
